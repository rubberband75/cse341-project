<!DOCTYPE html>
<html>

<head>
    <% include ../../../partials/header.ejs %>
</head>

<body>
    <% include ../../../partials/nav.ejs %>
        <% include ../partials/project01nav.ejs %>

            <div class="jumbotron text-center">
                <div class="container">
                    <h1>
                        <%= title %>
                    </h1>
                </div>
            </div>

            <div class="container">
                <hr>
                <% if (orders.length===0) { %>
                    <h2 class="text-center">You have no Orders</h2>
                    <hr>
                    <% } else { %>

                        <% orders.forEach(order=> { %>
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <h3 class="panel-title">
                                        Order on <%= new Date().toDateString() %>
                                            <span class="pull-right" style="font-size: 1rem">ORDER # <%= order._id %>
                                            </span>
                                    </h3>
                                </div>

                                <div class="panel-body">

                                    <% order.products.forEach(product=> { %>
                                        <div class="media">
                                            <div class="media-left">
                                                <a href="/project/01/products/<%= product.productData._id %>">
                                                    <img width="100" src="<%= product.productData.imageUrl %>"
                                                        alt="<%= product.productData.title %>"
                                                        title="<%= product.productData.title %>">
                                                </a>
                                            </div>
                                            <div class="media-body">
                                                <h3 class="media-heading">
                                                    <%= product.productData.title %>
                                                </h3>
                                                Quantity: <%= product.quantity %>
                                            </div>

                                            <div class="media-right">
                                                <h4 class="xmedia-heading">
                                                    $<%= (product.quantity * product.productData.price) %>
                                                </h4>
                                            </div>
                                        </div>
                                        <% }) %>


                                </div>
                                <div class="panel-footer">
                                    <div>
                                        &nbsp;
                                        <span class="pull-right">
                                            Order Total: $ <%= order.products.reduce((total, p)=> {
                                                return total + (p.quantity * p.productData.price)
                                                }, 0).toFixed(2) %>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <% }) %>
                                <hr>
                                <% } %>


            </div>

</body>

</html>